<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rassta">
<title>Classification Units • rassta</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Classification Units">
<meta property="og:description" content="rassta">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rassta</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/classunits.html">Classification Units</a>
    <a class="dropdown-item" href="../articles/modeling.html">Predictive Modeling Engine</a>
    <a class="dropdown-item" href="../articles/sampling.html">Stratified Non-Probability Sampling</a>
    <a class="dropdown-item" href="../articles/signature.html">Spatial Signature of Classification Units</a>
    <a class="dropdown-item" href="../articles/similarity.html">Landscape Similarity to Stratification Units</a>
    <a class="dropdown-item" href="../articles/stratunits.html">Stratification Units</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bafuentes/rassta/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="classunits_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Classification Units</h1>
                        <h4 data-toc-skip class="author">rassta: Raster-based Spatial Stratification Algorithms</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bafuentes/rassta/blob/HEAD/vignettes/classunits.Rmd" class="external-link"><code>vignettes/classunits.Rmd</code></a></small>
      <div class="d-none name"><code>classunits.Rmd</code></div>
    </div>

    
    
<hr>
<p>Get the data required for this vignette</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compressed folder with files from rassta’s installation folder</span>
<span class="va">wasoil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"exdat/wasoil.zip"</span>, package <span class="op">=</span> <span class="st">"rassta"</span><span class="op">)</span>
<span class="co"># Directory for temporary files</span>
<span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Copy compressed folder to directory for temporary files</span>
<span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">wasoil</span>, to <span class="op">=</span> <span class="va">o</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co"># Extract files to subfolder</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"/rassta"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"/wasoil.zip"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, exdir <span class="op">=</span> <span class="va">d</span><span class="op">)</span></code></pre></div>
<hr>
<p>Classification units are first-level spatial entities that result from the stratification of a landscape factor represented by <em>n</em> variables(s). One example of a landscape factor is <strong>climate</strong>, which can be represented by variables such as mean annual temperature or total annual precipitation. Accordingly, climatic classification units can result from the spatial stratification of temperature and precipitation through methods such as (bio)climatic classification schemes, cluster analysis, etc. Currently, <strong>rassta</strong> allows the creation of classification units based on dimension reduction and cluster analysis.</p>
<div class="section level2">
<h2 id="dimension-reduction-and-estimation-of-k">Dimension reduction and estimation of k<a class="anchor" aria-label="anchor" href="#dimension-reduction-and-estimation-of-k"></a>
</h2>
<p>The process to create classification units starts with the reduction of the feature space represented by <em>n</em> variables. This low-dimension representation of the feature space is created using the self-organizing map (SOM) technique of Kohonen (1982, 1990). Subsequently, cluster analysis is performed on the reduced feature space using the partitioning around medoids (PAM) algorithm (Kaufman and Rousseeuw, 1990). The ‘optimal’ number of clusters <em>k</em> is estimated with the <em>gap statistic</em> of Tibshirani et al. (2001). The packages <strong>kohonen</strong> (Wehrens and Kruisselbrink, 2018) and <strong>cluster</strong> (Maechler et al., 2021) are imported by <strong>rassta</strong> to perform the SOM technique and the PAM clustering with gap statistic, respectively.</p>
<p>The following code examples demonstrate how to reduce the feature space and estimate the optimum <em>k</em> using four terrain variables and the function <em>som_gap</em>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load rassta and terra packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bafuentes.github.io/rassta/">rassta</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span>
<span class="co"># Multi-layer SpatRaster with 4 terrain variables</span>
<span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"height.tif"</span>, <span class="st">"midslope.tif"</span>, <span class="st">"slope.tif"</span>, <span class="st">"wetness.tif"</span><span class="op">)</span>
<span class="va">vardir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">var</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>
<span class="va">terr.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">vardir</span><span class="op">)</span>
<span class="co"># Plot terrain variables</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zissou"</span>, <span class="st">"Batlow"</span>, <span class="st">"Lajolla"</span>, <span class="st">"Spectral"</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">terr.var</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">terr.var</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">nc</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3.5</span><span class="op">)</span>
      <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="classunits_files/figure-html/terrvars-1.png" width="528"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set seed</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">963</span><span class="op">)</span>
<span class="co"># Scale variables to mean = 0 and standard deviation = 1</span>
<span class="va">terr.varscale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">terr.var</span><span class="op">)</span>
<span class="co"># With terra::aggregate(), reduce spatial resolution to reduce computing time</span>
<span class="va">terr.varscale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">terr.varscale</span>, fact <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co"># Dimensionality reduction and estimation of optimum k (max k to evaluate: 9)</span>
<span class="va">terr.som</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/som_gap.html">som_gap</a></span><span class="op">(</span><span class="va">terr.varscale</span>, xdim <span class="op">=</span> <span class="fl">9</span>, ydim <span class="op">=</span> <span class="fl">9</span>, K.max <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>
<span class="co"># Plot results</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">terr.som</span><span class="op">$</span><span class="va">SOM</span>, main <span class="op">=</span> <span class="st">"SOM Codes"</span><span class="op">)</span> <span class="co"># Self-Organizing Map's codes</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">terr.som</span><span class="op">$</span><span class="va">SOMgap</span>, main <span class="op">=</span> <span class="st">"Gap Statistic"</span><span class="op">)</span> <span class="co"># Gap statistic</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">terr.som</span><span class="op">$</span><span class="va">Kopt</span><span class="op">)</span> <span class="co"># Optimum k</span></code></pre></div>
<p><img src="classunits_files/figure-html/terrclas-1.png" width="268.8"><img src="classunits_files/figure-html/terrclas-2.png" width="268.8"></p>
</div>
<div class="section level2">
<h2 id="rasterization-of-the-som-and-pam-outputs">Rasterization of the SOM and PAM outputs<a class="anchor" aria-label="anchor" href="#rasterization-of-the-som-and-pam-outputs"></a>
</h2>
<p>Once the feature space has been reduced and the optimum <em>k</em> has been estimated with <em>som_gap</em>, rasterized versions of the SOM and PAM outputs can be created with the function <em>som_pam</em>. The rasterized PAM represents the final set of classification units for a landscape factor. Note that any other clustering algorithm outside of <strong>rassta</strong> can be used to create classification units from the output SOM of <em>som_gap</em>.</p>
<p>The code below demonstrates the creation of classification units with <em>som_pam</em>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create reference SpatRaster</span>
<span class="va">rastref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">terr.var</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, fact <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co"># Rasterization of terrain SOM grid and terrain PAM clustering</span>
<span class="va">terr.sompam</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/som_pam.html">som_pam</a></span><span class="op">(</span>ref.rast <span class="op">=</span> <span class="va">rastref</span>, kohsom <span class="op">=</span> <span class="va">terr.som</span><span class="op">$</span><span class="va">SOM</span>,
                       k <span class="op">=</span> <span class="va">terr.som</span><span class="op">$</span><span class="va">Kopt</span>
                      <span class="op">)</span>
<span class="co"># Plot results</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">terr.sompam</span><span class="op">$</span><span class="va">sompam.rast</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Terrain Self-Organizing Map"</span>,
     mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">3.3</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"spectral"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">terr.sompam</span><span class="op">$</span><span class="va">sompam.rast</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Terrain Classification Units"</span>,
     type <span class="op">=</span> <span class="st">"classes"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="va">terr.som</span><span class="op">$</span><span class="va">Kopt</span>, <span class="st">"spectral"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
     mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<p><img src="classunits_files/figure-html/terrclasr-1.png" width="268.8"><img src="classunits_files/figure-html/terrclasr-2.png" width="268.8"></p>
<div class="section level3">
<h3 id="reclassification">Reclassification<a class="anchor" aria-label="anchor" href="#reclassification"></a>
</h3>
<p>Note that using <strong>terra</strong>, the numeric IDs of classification units can be reassigned according to the interpretation of each unit. The assignment of new IDs for classes is commonly referred to as ‘reclassification’ in the geospatial analysis literature. In the next code example, the numeric ID of the terrain classification units are reassigned based on the variable <em>height</em>. Terrain classes at higher relative positions (e.g., summits) will have values closer to one. Conversely, terrain classes at lower relative positions (e.g., stream channels) will have values closer to 6.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract rasterized PAM solution</span>
<span class="va">terr.cu</span> <span class="op">&lt;-</span> <span class="va">terr.sompam</span><span class="op">$</span><span class="va">sompam.rast</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="co"># With terra::zonal(), unit-wise mean value of terrain height</span>
<span class="va">terrh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">terr.var</span><span class="op">$</span><span class="va">height</span>, fact <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># Match spatial resolution</span>
<span class="va">terr.stat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/zonal.html" class="external-link">zonal</a></span><span class="op">(</span><span class="va">terrh</span>, <span class="va">terr.cu</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>
<span class="co"># Order numeric IDs based on terrain height (descending)</span>
<span class="va">terr.stat</span> <span class="op">&lt;-</span> <span class="va">terr.stat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">terr.stat</span><span class="op">$</span><span class="va">height</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span>
<span class="co"># Column with original numeric IDs</span>
<span class="va">terr.stat</span><span class="op">$</span><span class="va">CU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">terr.som</span><span class="op">$</span><span class="va">Kopt</span><span class="op">)</span>
<span class="co"># With terra::classify(), reclassify numeric IDs</span>
<span class="va">terr.cu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/classify.html" class="external-link">classify</a></span><span class="op">(</span><span class="va">terr.cu</span>, <span class="va">terr.stat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co"># Plot original and reclassified terrain classification units</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">terr.sompam</span><span class="op">$</span><span class="va">sompam.rast</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Terrain Classification Units"</span>,
     type <span class="op">=</span> <span class="st">"classes"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="va">terr.som</span><span class="op">$</span><span class="va">Kopt</span>, <span class="st">"spectral"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
     mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span><span class="op">)</span>
    <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">terr.cu</span>, type <span class="op">=</span> <span class="st">"classes"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="va">terr.som</span><span class="op">$</span><span class="va">Kopt</span>, <span class="st">"spectral"</span><span class="op">)</span>,
     main <span class="op">=</span> <span class="st">"Reclassified Terrain Classification Units"</span>,
     mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<p><img src="classunits_files/figure-html/terrclasrec-1.png" width="268.8"><img src="classunits_files/figure-html/terrclasrec-2.png" width="268.8"></p>
<hr>
<p>Clean files from temporary directory</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"/wasoil.zip"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="va">d</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>B.A. Fuentes, M.J. Dorantes, and J.R. Tipton. rassta: Raster-based Spatial Stratification Algorithms. <em>EarthArXiv</em>, 2021. <a href="https://doi.org/10.31223/X50S57" class="external-link uri">https://doi.org/10.31223/X50S57</a></p></li>
<li><p>L. Kaufman and P. Rousseeuw. Finding groups in data: an introduction to cluster analysis. <em>John Wiley &amp; Sons</em>, 1990. <a href="https://doi.org/10.1002/9780470316801" class="external-link uri">https://doi.org/10.1002/9780470316801</a></p></li>
<li><p>T. Kohonen. Self-organized formation of topologically correct feature maps. <em>Biological Cybernetics</em>, 43 (1):59–69, 1982. <a href="https://doi.org/10.1007/bf00337288" class="external-link uri">https://doi.org/10.1007/bf00337288</a></p></li>
<li><p>T. Kohonen. The self-organizing map. <em>Proceedings of the IEEE</em>, 1990. <a href="https://doi.org/10.1016/s0925-2312(98)00030-7" class="external-link uri">https://doi.org/10.1016/s0925-2312(98)00030-7</a></p></li>
<li><p>M. Maechler, P. Rousseeuw, A. Struyf, M. Hubert, and K. Hornik. cluster: Cluster Analysis Basics and Extensions. <em>R package</em> version 2.1.2, 2021. <a href="https://CRAN.R-project.org/package=cluster" class="external-link uri">https://CRAN.R-project.org/package=cluster</a></p></li>
<li><p>R. Tibshirani, G. Walther, and T. Hastie. Estimating the number of clusters in a data set via the gap statistic. <em>Journal of the Royal Statistical Society</em>: Series B (Statistical Methodology), 63(2):411–423, 2001. <a href="https://doi.org/10.1111/1467-9868.00293" class="external-link uri">https://doi.org/10.1111/1467-9868.00293</a></p></li>
<li><p>R. Wehrens and J. Kruisselbrink. Flexible self-organizing maps in kohonen 3.0. <em>Journal of Statistical Software</em>, 87(1):1–18, 2018. <a href="https://doi.org/10.18637/jss.v087.i07" class="external-link uri">https://doi.org/10.18637/jss.v087.i07</a></p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bryan A. Fuentes, Minerva J. Dorantes, John R. Tipton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
