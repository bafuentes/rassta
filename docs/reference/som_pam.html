<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creation of a rasterized representation of the outputs from the
self-organizing map (SOM) and partitioning around medoids (PAM). Given a
reference raster layer, each winning unit of the SOM and clustering value
from the PAM will be mapped on the corresponding cell in the reference layer
and across the geographic space supported by such layer. Note that this
function is a follow-up of the som_gap function."><title>Rasterization of Self-Organizing Map and Partitioning Around Medoids — som_pam • rassta</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rasterization of Self-Organizing Map and Partitioning Around Medoids — som_pam"><meta property="og:description" content="Creation of a rasterized representation of the outputs from the
self-organizing map (SOM) and partitioning around medoids (PAM). Given a
reference raster layer, each winning unit of the SOM and clustering value
from the PAM will be mapped on the corresponding cell in the reference layer
and across the geographic space supported by such layer. Note that this
function is a follow-up of the som_gap function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rassta</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/classunits.html">Classification Units</a>
    <a class="dropdown-item" href="../articles/modeling.html">Predictive Modeling Engine</a>
    <a class="dropdown-item" href="../articles/sampling.html">Stratified Non-Probability Sampling</a>
    <a class="dropdown-item" href="../articles/signature.html">Spatial Signature of Classification Units</a>
    <a class="dropdown-item" href="../articles/similarity.html">Landscape Similarity to Stratification Units</a>
    <a class="dropdown-item" href="../articles/stratunits.html">Stratification Units</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bafuentes/rassta/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Rasterization of Self-Organizing Map and Partitioning Around Medoids</h1>
      <small class="dont-index">Source: <a href="https://github.com/bafuentes/rassta/blob/HEAD/R/som_pam.r" class="external-link"><code>R/som_pam.r</code></a></small>
      <div class="d-none name"><code>som_pam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creation of a rasterized representation of the outputs from the
self-organizing map (SOM) and partitioning around medoids (PAM). Given a
reference raster layer, each winning unit of the SOM and clustering value
from the PAM will be mapped on the corresponding cell in the reference layer
and across the geographic space supported by such layer. Note that this
function is a follow-up of the <code><a href="som_gap.html">som_gap</a></code> function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">som_pam</span><span class="op">(</span><span class="va">ref.rast</span>, <span class="va">kohsom</span>, <span class="va">k</span>, metric <span class="op">=</span> <span class="st">"manhattan"</span>, stand <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ref.rast</dt>
<dd><p>SpatRaster, as in <code><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></code>. This raster
layer will serve as a reference of the index of valid cells and the
geographic support for the rasterized representation of SOM's winning units
and PAM's clustering. See <em>Details</em> for some notes about efficiency.</p></dd>


<dt>kohsom</dt>
<dd><p>SOM Object of class <strong>kohonen</strong>, see
<code><a href="https://rdrr.io/pkg/kohonen/man/supersom.html" class="external-link">supersom</a></code>. The following components must be present
in the SOM object (1) <em>unit.classif</em> = winning units for all
observations, and (2) <em>codes</em> = matrix of codebook vectors.</p></dd>


<dt>k</dt>
<dd><p>Integer (positive value). Number of clusters to form from the
codebook vectors of the SOM, where <em>k &lt; SOM's codebook vectors</em>.</p></dd>


<dt>metric</dt>
<dd><p>Character. Distance function for PAM. Options are "euclidean",
and "manhattan". Default: "manhattan"</p></dd>


<dt>stand</dt>
<dd><p>Boolean. For the PAM function, do SOM's codebook vectors need to
be standardized? Default: FALSE</p></dd>


<dt>...</dt>
<dd><p>Additional arguments as for <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">pam</a></code>. See
<strong>Details</strong>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><strong>sompam</strong>: Object of class <strong>pam</strong>. See ?pam.object for details.</p>


<p><strong>sompam.rast</strong>: Multi-layer SpatRaster, as in
<code><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></code>. The first raster layer corresponds to the SOM's
winning units. The second raster layer corresponds to the clustered SOM's
codebook vectors by PAM.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>As in <code><a href="som_gap.html">som_gap</a></code>, this function calls <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">pam</a></code>
to perform the clustering of SOM's codebook vectors. The SOM object must
belong to the class <strong>kohonen</strong>, as in <code><a href="https://rdrr.io/pkg/kohonen/man/supersom.html" class="external-link">supersom</a></code>.</p>
<p>Note that in order for <code>som_pam</code> to perform efficiently, the
reference SpatRaster <em>ref.rast</em> must be a single-layer SpatRaster with
the same cell size, number of rows, number of columns, and index of valid
cells as those in the multi-layer SpatRaster object used in
<code><a href="som_gap.html">som_gap</a></code>. If a multi-layer SpatRaster (with each layer possibly
having a different index of valid cells) is used as the <em>ref.rast</em>, the
efficiency of <code>som_pam</code> (i.e., running time and/or memory
allocation) may be degraded when handling large SpatRaster objects.</p>
<p>For this function to work as intended, the additional argument
<em>cluster.only</em> in <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">pam</a></code> must remain as FALSE, which
is the default.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Functions for Landscape Stratification: 
<code><a href="som_gap.html">som_gap</a>()</code>,
<code><a href="strata.html">strata</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Multi-layer SpatRaster with topographic variables</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"exdat"</span>, package <span class="op">=</span> <span class="st">"rassta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">p</span>, pattern <span class="op">=</span> <span class="st">"^height|^slope|^wetness"</span>,</span></span>
<span class="r-in"><span>                 full.names <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>                <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Scale topographic variables (mean = 0, StDev = 1)</span></span></span>
<span class="r-in"><span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Self-organizing map and gap statistic for optimum k</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">963</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tsom</span> <span class="op">&lt;-</span> <span class="fu"><a href="som_gap.html">som_gap</a></span><span class="op">(</span>var.rast <span class="op">=</span> <span class="va">ts</span>, xdim <span class="op">=</span> <span class="fl">8</span>, ydim <span class="op">=</span> <span class="fl">8</span>, rlen <span class="op">=</span> <span class="fl">150</span>,</span></span>
<span class="r-in"><span>               mode <span class="op">=</span> <span class="st">"online"</span>, K.max <span class="op">=</span> <span class="fl">6</span>, B <span class="op">=</span> <span class="fl">300</span>, spaceH0 <span class="op">=</span> <span class="st">"original"</span>,</span></span>
<span class="r-in"><span>               method <span class="op">=</span> <span class="st">"globalSEmax"</span></span></span>
<span class="r-in"><span>              <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering k = 1,2,..., K.max (= 6): .. done</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrapping, b = 1,2,..., B (= 300)  [one "." per sample]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .................................................. 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .................................................. 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .................................................. 150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .................................................. 200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .................................................. 250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .................................................. 300 </span>
<span class="r-in"><span><span class="co"># Optimum k</span></span></span>
<span class="r-in"><span><span class="va">tsom</span><span class="op">$</span><span class="va">Kopt</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-in"><span><span class="co"># PAM clustering of topographic SOM's codebook vectors</span></span></span>
<span class="r-in"><span><span class="va">tpam</span> <span class="op">&lt;-</span> <span class="fu">som_pam</span><span class="op">(</span>ref.rast <span class="op">=</span> <span class="va">t</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, kohsom <span class="op">=</span> <span class="va">tsom</span><span class="op">$</span><span class="va">SOM</span>, k <span class="op">=</span> <span class="va">tsom</span><span class="op">$</span><span class="va">Kopt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot topographic variables, SOM grid and PAM clustering</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">tpam</span><span class="op">$</span><span class="va">sompam.rast</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="som_pam-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bryan A. Fuentes, Minerva J. Dorantes, John R. Tipton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

