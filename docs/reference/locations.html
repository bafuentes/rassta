<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Select Representative Sampling Locations for Stratification Units — locations • rassta</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Select Representative Sampling Locations for Stratification Units — locations" />
<meta property="og:description" content="Selection of the representative sampling locations based on landscape
similarity values. For a give stratification unit, the representative
sampling location is the XY position where the highest landscape similarity
value occurs. This location is assumed to best reflect the influence that the
landscape configuration of a given stratification unit exerts on response
phenomena. Currently, two selection methods are supported: (1) maximum
similarity within buffer zones (&quot;buffer&quot;), and (2) absolute maximum
similarity (&quot;absolute&quot;). For the buffer method, the n largest zones
enclosing landscape similarity values above a certain threshold are first
identified. Then, for each zone, one sample is placed at the XY
location where the landscape similarity value is maximized. For the absolute
method, a sample is placed at the XY locations with the n
maximum landscape similarity values. In both methods, it is possible to
constrain the sampling process to the boundaries of the stratification unit.
Constraining the process ensures that the sampling locations determined for a
given unit are placed within the boundaries of that unit. See
Details for some guidance in the use of this function for
classification units." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rassta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/classunits.html">Classification Units</a>
    </li>
    <li>
      <a href="../articles/modeling.html">Predictive Modeling Engine</a>
    </li>
    <li>
      <a href="../articles/sampling.html">Stratified Non-Probability Sampling</a>
    </li>
    <li>
      <a href="../articles/signature.html">Spatial Signature of Classification Units</a>
    </li>
    <li>
      <a href="../articles/similarity.html">Landscape Similarity to Stratification Units</a>
    </li>
    <li>
      <a href="../articles/stratunits.html">Stratification Units</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bafuentes/rassta/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Select Representative Sampling Locations for Stratification Units</h1>
    <small class="dont-index">Source: <a href='https://github.com/bafuentes/rassta/blob/master/R/locations.r'><code>R/locations.r</code></a></small>
    <div class="hidden name"><code>locations.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Selection of the <em>representative sampling locations</em> based on landscape
similarity values. For a give stratification unit, the representative
sampling location is the XY position where the highest landscape similarity
value occurs. This location is assumed to best reflect the influence that the
landscape configuration of a given stratification unit exerts on response
phenomena. Currently, two selection methods are supported: (1) <em>maximum
similarity within buffer zones</em> ("buffer"), and (2) <em>absolute maximum
similarity</em> ("absolute"). For the buffer method, the <em>n</em> largest zones
enclosing landscape similarity values above a certain threshold are first
identified. Then, for each zone, one sample is placed at the <em>XY</em>
location where the landscape similarity value is maximized. For the absolute
method, a sample is placed at the <em>XY</em> locations with the <em>n</em>
maximum landscape similarity values. In both methods, it is possible to
constrain the sampling process to the boundaries of the stratification unit.
Constraining the process ensures that the sampling locations determined for a
given unit are placed within the boundaries of that unit. See
<strong>Details</strong> for some guidance in the use of this function for
classification units.</p>
    </div>

    <pre class="usage"><span class='fu'>locations</span><span class='op'>(</span>
  <span class='va'>ls.rast</span>,
  <span class='va'>su.rast</span>,
  method <span class='op'>=</span> <span class='st'>"buffer"</span>,
  constrained <span class='op'>=</span> <span class='cn'>TRUE</span>,
  buf.quant <span class='op'>=</span> <span class='fl'>0.9</span>,
  buf.n <span class='op'>=</span> <span class='fl'>1</span>,
  abs.n <span class='op'>=</span> <span class='fl'>1</span>,
  tol <span class='op'>=</span> <span class='fl'>2</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  to.disk <span class='op'>=</span> <span class='cn'>FALSE</span>,
  outdir <span class='op'>=</span> <span class='st'>"."</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ls.rast</th>
      <td><p>SpatRaster, as in <code><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></code>. Multi-layer
SpatRaster representing landscape similarities to stratification units.</p></td>
    </tr>
    <tr>
      <th>su.rast</th>
      <td><p>SpatRaster. Single-layer SpatRaster representing the
stratification units occurring across geographic space. Integer values are
expected as cell values (i.e., numeric codes) of stratification units.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Character. String denoting the sampling method. Current options
are "buffer" for the maximum similarity within buffer zones method, and
"absolute" for the absolute maximum similarity method. Default: "buffer"</p></td>
    </tr>
    <tr>
      <th>constrained</th>
      <td><p>Boolean. Should the sampling process be constrained to the
boundaries of each stratification unit? See <strong>Details</strong>. Default: TRUE</p></td>
    </tr>
    <tr>
      <th>buf.quant</th>
      <td><p>Numeric. Number expressed in quantile notation (0-1)
indicating the similarity threshold for the creation of buffer zones. Only
zones enclosing raster cells with <em>landscape similarity &gt;= buf.quant</em>
will be created and thus, considered for sampling. See <strong>Details</strong>.
Default: 0.9</p></td>
    </tr>
    <tr>
      <th>buf.n</th>
      <td><p>Integer. Positive integer indicating the <em>n</em> largest buffer
zones for which sampling locations will be selected (<em>n</em> buffer zones
per stratification unit, one sampling location per buffer zone). Default: 1</p></td>
    </tr>
    <tr>
      <th>abs.n</th>
      <td><p>Integer. When <em>method = "absolute"</em>, Positive integer
indicating the number of sampling locations to select for each
stratification unit. See <strong>Details</strong>. Default: 1</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Numeric. This number will be subtracted from the sampled maximum
value of a landscape similarity layer to ensure two things: (1) that the
'true' maximum similarity value is found regardless of the size of the
layer, and (2) that the requested number of sampling locations will be
found (see <strong>Details</strong>). The default assumes that landscape similarity
values are on a scale of 1 to 100. If these values are on a different scale
(e.g., decimal), then, <em>tol</em> needs to be adjusted accordingly.
Default: 2</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Boolean. Perform parallel processing? A parallel backend must
be registered beforehand with <code><a href='https://rdrr.io/pkg/doParallel/man/registerDoParallel.html'>registerDoParallel</a></code>.
Keep in mind that the amount of RAM to allocate when performing parallel
processing can result prohibitive for large data sets. Default: FALSE</p></td>
    </tr>
    <tr>
      <th>to.disk</th>
      <td><p>Boolean. Should output SpatVector(s) (as in
<code><a href='https://rdrr.io/pkg/terra/man/vect.html'>vect</a></code>) be written to disk? Default: FALSE</p></td>
    </tr>
    <tr>
      <th>outdir</th>
      <td><p>Character. If <em>to.disk = TRUE</em>, string specifying the path
for the output SpatVector(s). Default: "."</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Boolean. Show warning messages in the console? Default: FALSE</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments, as for <code><a href='https://rdrr.io/pkg/terra/man/writeVector.html'>writeVector</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <em>method = "buffer"</em> and <em>constrained = TRUE</em>, a list with the
following components:</p>
<p><strong>locations</strong>: SpatVector of point geometry. Each point in this vector
represents the sampling location placed at the maximum landscape similarity
value within a stratification unit's buffer zone. Tabular attributes in this
SpatVector are (1) <em>SU</em> = stratification unit's numeric code, (2)
<em>land_sim</em> = landscape similarity value, (3) <em>x</em> = X coordinate,
and (4) <em>y</em> = Y coordinate.</p>
<p><strong>buffer</strong>: SpatVector of polygon geometry. Each polygon in this vector
represents the buffer zone of an stratification unit.</p>
<p>If <em>method = "buffer"</em> and <em>constrained = FALSE</em>:</p>
<p><strong>locations</strong>: Same as <strong>locations</strong> from <em>method = "buffer"</em>
and <em>constrained = TRUE</em>.</p>
<p>If <em>method = "absolute"</em>:</p>
<p><strong>locations</strong>: SpatVector of point geometry. Each point in this vector
represents the sampling location placed at the maximum landscape similarity
value for an stratification unit. Tabular attributes in this SpatVector are
(1) <em>SU</em> = stratification unit's numeric code, (2) <em>land_sim</em> =
landscape similarity value, (3) <em>x</em> = X coordinate, and (4) <em>y</em> = Y
coordinate.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Except when <em>buf.n = 1</em> or <em>abs.n = 1</em>, the number of returned
sampling locations per stratification unit may be smaller than requested,
especially when <em>constrained = TRUE</em>. For the constrained buffer method,
reducing the landscape similarity threshold value <em>buf.quant</em> will not
always result in more buffer zones; i.e., more sampling locations. The reason
for this is that reducing the threshold value for the creation of buffer
zones may actually promote the spatial contiguity of zones. For instance, two
buffer zones created at <em>buf.quant = 0.9</em>, may be merged into a single
buffer zone when <em>buf.quant = 0.80</em>. This will occur if the raster cells
between the two buffer zones satisfy: <em>landscape similarity &gt;=
quantile(landscape similarity, 0.8)</em>. For the absolute method, increasing the
value of the <em>tol</em> argument will ensure a safer search for <em>n</em>
sampling locations and thus, greater chances of getting the total number of
requested sampling locations per stratification unit.</p>
<p>Note that this sampling scheme can be applied for classification units. In
order to do this, one should replace the multi-layer SpatRaster of landscape
similarities with a multi-layer SpatRaster of spatial signatures. One should
also replace the raster layer of stratification units with that of
classification units.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='similarity.html'>similarity</a></code>, <code><a href='strata.html'>strata</a></code></p>
<p>Other Functions for Stratified Sampling: 
<code><a href='observation.html'>observation</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/terra/'>terra</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"exdat"</span>, package <span class='op'>=</span> <span class='st'>"rassta"</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Multi-layer SpatRaster of landscape similarities</span></span>
<span class='r-in'><span class='va'>fls</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>p</span>, pattern <span class='op'>=</span> <span class='st'>"su_"</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>ls</span> <span class='op'>&lt;-</span> <span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></span><span class='op'>(</span><span class='va'>fls</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Single-layer SpatRaster of stratification units</span></span>
<span class='r-in'><span class='va'>fsu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='va'>p</span>, pattern <span class='op'>=</span> <span class='st'>"strata.tif"</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>su</span> <span class='op'>&lt;-</span> <span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></span><span class='op'>(</span><span class='va'>fsu</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Get 1 representative sampling location per stratification unit</span></span>
<span class='r-in'><span class='va'>rl</span> <span class='op'>&lt;-</span> <span class='fu'>locations</span><span class='op'>(</span>ls.rast <span class='op'>=</span> <span class='va'>ls</span>, su.rast <span class='op'>=</span> <span class='va'>su</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Plot representative locations (including buffer areas)</span></span>
<span class='r-in'><span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>su</span>, type <span class='op'>=</span> <span class='st'>"classes"</span>, fun <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>rl</span><span class='op'>$</span><span class='va'>locations</span><span class='op'>)</span>,</span>
<span class='r-in'>                                                <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>polys</a></span><span class='op'>(</span><span class='va'>rl</span><span class='op'>$</span><span class='va'>buffers</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'>      <span class='op'>)</span><span class='op'>}</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bryan A. Fuentes, Minerva J. Dorantes, John R. Tipton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


