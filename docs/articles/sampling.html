<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stratified Non-Probability Sampling • rassta</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Stratified Non-Probability Sampling">
<meta property="og:description" content="rassta">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rassta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/classunits.html">Classification Units</a>
    </li>
    <li>
      <a href="../articles/modeling.html">Predictive Modeling Engine</a>
    </li>
    <li>
      <a href="../articles/sampling.html">Stratified Non-Probability Sampling</a>
    </li>
    <li>
      <a href="../articles/signature.html">Spatial Signature of Classification Units</a>
    </li>
    <li>
      <a href="../articles/similarity.html">Landscape Similarity to Stratification Units</a>
    </li>
    <li>
      <a href="../articles/stratunits.html">Stratification Units</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bafuentes/rassta/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sampling_files/header-attrs-2.11.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stratified Non-Probability Sampling</h1>
                        <h4 class="author">rassta: Raster-based Spatial Stratification Algorithms</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bafuentes/rassta/blob/master/vignettes/sampling.Rmd"><code>vignettes/sampling.Rmd</code></a></small>
      <div class="hidden name"><code>sampling.Rmd</code></div>

    </div>

    
    
<hr>
<p>Get the data required for this vignette</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compressed folder with files from rassta’s installation folder</span>
<span class="va">wasoil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"exdat/wasoil.zip"</span>, package <span class="op">=</span> <span class="st">"rassta"</span><span class="op">)</span>
<span class="co"># Directory for temporary files</span>
<span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Copy compressed folder to directory for temporary files</span>
<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">wasoil</span>, to <span class="op">=</span> <span class="va">o</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co"># Extract files to subfolder</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"/rassta"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"/wasoil.zip"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, exdir <span class="op">=</span> <span class="va">d</span><span class="op">)</span></code></pre></div>
<hr>
<p>The use of stratification units for sampling allows adequate representations of the feature space, improved modeling performance, and cost-efficient field work. Accordingly, <strong>rassta</strong> allows the stratified selection of observations from an existing sample and the selection of <em>XY</em> locations to create a new sample. The stratified sampling with <strong>rassta</strong> can include the landscape similarity layers. Accounting for the landscape similarity will ensure that the observation/location selected for a given stratification unit is the one which best reflects the landscape configuration represented by the unit. The use of landscape similarity layers in the sampling process results in a stratified, non-probability sample.</p>
<div id="selection-of-representative-observations" class="section level2">
<h2 class="hasAnchor">
<a href="#selection-of-representative-observations" class="anchor"></a>Selection of representative observations</h2>
<p>The selection of observations from an existing sample with <strong>rassta</strong> results in one observation per stratification unit in a set. This observation is termed the <em>representative response observation</em>. The representative response observation is assumed to best reflect the control that the landscape configuration represented by a stratification unit exerts on response phenomena. Currently, <strong>rassta</strong> allows to select a representative response observation for each stratification unit in a set based on the following methods:</p>
<ul>
<li>
<em>mls</em>: selects the observation at the location with the maximum landscape similarity value.</li>
<li>
<em>mrv</em>: selects the observation whose response value is the median of all the values.</li>
<li>
<em>random</em>: selects an observation at random.</li>
</ul>
<p>The first two methods represent a stratified non-probability sampling, while the third method represents a stratified random sampling. Moreover, the first method is biased towards maximizing the representativeness of landscape configurations because it uses landscape similarity layers. The codes below demonstrate the selection of representative response observations with <em>observation()</em>. The observations will be selected from a sample of <em>n</em> = 195 based on the <em>mls</em> method.</p>
<ul>
<li>Creation of multi-layer SpatRaster with landscape similarity to stratification units.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load rassta and terra packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bafuentes.github.io/rassta/">rassta</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/">terra</a></span><span class="op">)</span>
<span class="co"># Single-layer SpatRaster of stratification units</span>
<span class="va">su</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"/su.tif"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Multi-layer SpatRaster with spatial signatures of classification units</span>
<span class="va">clim.sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">d</span>, pattern <span class="op">=</span> <span class="st">"climate_"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># For climatic units</span>
<span class="va">mat.sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">d</span>, pattern <span class="op">=</span> <span class="st">"material_"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># For material units</span>
<span class="va">terr.sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">d</span>, pattern <span class="op">=</span> <span class="st">"terrain_"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># For terrain units</span>
<span class="co"># Landscape similarity to stratification units</span>
<span class="va">su.ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity.html">similarity</a></span><span class="op">(</span>su.rast <span class="op">=</span> <span class="va">su</span>, sig.rast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="va">clim.sig</span>, <span class="va">mat.sig</span>, <span class="va">terr.sig</span><span class="op">)</span>,
                    su.code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>climate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,
                                   material <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                                   terrain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>
                                   <span class="op">)</span>
                  <span class="op">)</span></code></pre></div>
<ul>
<li>Selection of the representative response observation for each stratification unit. The response variable in this example is soil organic carbon (SOC).</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># SpatVector with SOC observations for stratification units</span>
<span class="va">socobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"/soc.shp"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Representative SOC observation for each stratification unit</span>
<span class="va">su.obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observation.html">observation</a></span><span class="op">(</span>su.rast <span class="op">=</span> <span class="va">su</span>, obs <span class="op">=</span> <span class="va">socobs</span>, col.id <span class="op">=</span> <span class="fl">1</span>, col.resp <span class="op">=</span> <span class="fl">2</span>,
                      method <span class="op">=</span> <span class="st">"mls"</span>, ls.rast <span class="op">=</span> <span class="va">su.ls</span><span class="op">$</span><span class="va">landsim</span>
                      <span class="op">)</span>
<span class="co"># Information about sample and representative SOC observations</span>
<span class="va">socobs</span>
<span class="co">#&gt;  class       : SpatVector </span>
<span class="co">#&gt;  geometry    : points </span>
<span class="co">#&gt;  dimensions  : 195, 2  (geometries, attributes)</span>
<span class="co">#&gt;  extent      : 284252, 292532, 153471, 161811  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt;  coord. ref. : NAD83 / Washington South (EPSG:32149) </span>
<span class="co">#&gt;  names       :    ID   soc</span>
<span class="co">#&gt;  type        : &lt;num&gt; &lt;num&gt;</span>
<span class="co">#&gt;  values      :     1 6.603</span>
<span class="co">#&gt;                    2 5.701</span>
<span class="co">#&gt;                    3 5.594</span>
<span class="va">su.obs</span><span class="op">$</span><span class="va">su_repobs.sp</span>
<span class="co">#&gt;  class       : SpatVector </span>
<span class="co">#&gt;  geometry    : points </span>
<span class="co">#&gt;  dimensions  : 56, 4  (geometries, attributes)</span>
<span class="co">#&gt;  extent      : 284252, 292532, 153651, 161811  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt;  coord. ref. : NAD83 / Washington South (EPSG:32149) </span>
<span class="co">#&gt;  names       :    ID   soc    SU land_sim</span>
<span class="co">#&gt;  type        : &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;</span>
<span class="co">#&gt;  values      :     1 6.603   111    80.67</span>
<span class="co">#&gt;                    6 5.443   112       85</span>
<span class="co">#&gt;                   10 4.609   114    77.33</span></code></pre></div>
<ul>
<li>The spatial and statistical distribution of the sample and representative response observations can be plotted as demonstrated in the code below.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set graphics arrangement</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Plot stratification units and response observations</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">su</span>, type <span class="op">=</span> <span class="st">"classes"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">56</span>, <span class="st">"spectral"</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>,
     mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1.5</span><span class="op">)</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Soil Organic Carbon Observations"</span><span class="op">)</span>,
     fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">socobs</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
                        <span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">su.obs</span><span class="op">$</span><span class="va">su_repobs.sp</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
                      <span class="op">)</span>
    <span class="op">)</span>
<span class="co"># Set new graphics arrangement</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Plot histogram of soil organic carbon values from all observations</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html">hist</a></span><span class="op">(</span><span class="va">socobs</span><span class="op">$</span><span class="va">soc</span>, <span class="fl">4</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Soil Organic Carbon (%)"</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="co"># Plot histogram of soil organic carbon values from representative observations</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html">hist</a></span><span class="op">(</span><span class="va">su.obs</span><span class="op">$</span><span class="va">su_repobs.sp</span><span class="op">$</span><span class="va">soc</span>, <span class="fl">4</span>, add <span class="op">=</span> <span class="cn">T</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.9</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Add legend</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="st">"Representative Observations"</span><span class="op">)</span>,
       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.9</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, bty <span class="op">=</span> <span class="st">"n"</span>, pt.cex <span class="op">=</span> <span class="fl">2</span>,
       cex <span class="op">=</span> <span class="fl">0.6</span>, text.col <span class="op">=</span> <span class="st">"black"</span>, horiz <span class="op">=</span> <span class="cn">F</span>, inset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span>
      <span class="op">)</span></code></pre></div>
<p><img src="sampling_files/figure-html/dist-1.png" width="672"></p>
</div>
<div id="selection-of-representative-sampling-locations" class="section level2">
<h2 class="hasAnchor">
<a href="#selection-of-representative-sampling-locations" class="anchor"></a>Selection of representative sampling locations</h2>
<p>For those cases when a sample with observations of a response phenomenon is not available, <strong>rassta</strong> allows to define <em>XY</em> locations that can be used to establish field sampling campaigns. The selection of representative sampling locations is performed for each stratification unit in a set, and it utilizes the landscape similarity layers to define the <em>XY</em> locations. Currently, <strong>rassta</strong> allows to select representative sampling locations based on two approaches:</p>
<ul>
<li><p><em>buffer</em>: selects the <em>XY</em> location(s) within spatially contiguous areas with landscape similarity values above a user-defined threshold.</p></li>
<li><p><em>absolute</em>: selects the <em>XY</em> location(s) with the <em>n</em> highest landscape similarity values.</p></li>
</ul>
<p>The code below demonstrates the selection of representative sampling locations with the function <em>locations()</em>, based on the <em>buffer</em> method.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Representative sampling location and its buffer area for each stratification unit</span>
<span class="va">su.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/locations.html">locations</a></span><span class="op">(</span>ls.rast <span class="op">=</span> <span class="va">su.ls</span><span class="op">$</span><span class="va">landsim</span>, su.rast <span class="op">=</span> <span class="va">su</span>, method <span class="op">=</span> <span class="st">"buffer"</span><span class="op">)</span>
<span class="co"># Information about representative sampling locations and corresponding buffer areas</span>
<span class="va">su.samp</span><span class="op">$</span><span class="va">locations</span>
<span class="co">#&gt;  class       : SpatVector </span>
<span class="co">#&gt;  geometry    : points </span>
<span class="co">#&gt;  dimensions  : 56, 4  (geometries, attributes)</span>
<span class="co">#&gt;  extent      : 284042, 292532, 153351, 161841  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt;  coord. ref. : NAD83 / Washington South (EPSG:32149) </span>
<span class="co">#&gt;  names       :    SU land_sim         x         y</span>
<span class="co">#&gt;  type        : &lt;num&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="co">#&gt;  values      :   111    92.67 2.845e+05  1.55e+05</span>
<span class="co">#&gt;                  112    89.33 2.843e+05 1.572e+05</span>
<span class="co">#&gt;                  113    90.67 2.841e+05 1.552e+05</span>
<span class="va">su.samp</span><span class="op">$</span><span class="va">buffers</span>
<span class="co">#&gt;  class       : SpatVector </span>
<span class="co">#&gt;  geometry    : polygons </span>
<span class="co">#&gt;  dimensions  : 56, 2  (geometries, attributes)</span>
<span class="co">#&gt;  extent      : 284027, 292547, 153336, 161856  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt;  coord. ref. : NAD83 / Washington South (EPSG:32149) </span>
<span class="co">#&gt;  names       :                                           geometry    SU</span>
<span class="co">#&gt;  type        :                                              &lt;chr&gt; &lt;num&gt;</span>
<span class="co">#&gt;  values      : MULTIPOLYGON (((284027 156006, 284087 156006, 284~   116</span>
<span class="co">#&gt;                MULTIPOLYGON (((284447 155406, 284447 155376, 284~   113</span>
<span class="co">#&gt;                MULTIPOLYGON (((285167 155106, 285287 155106, 285~   117</span></code></pre></div>
<p>The spatial distribution of representative sampling locations and the statistical distribution of landscape similarity can be plotted as demonstrated in the code below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set graphics arrangement</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Plot stratification units, representative sampling locations and buffer areas</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">su</span>, type <span class="op">=</span> <span class="st">"classes"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">56</span>, <span class="st">"spectral"</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>,
     mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1.5</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Representative Sampling Locations"</span>,
     fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">polys</a></span><span class="op">(</span><span class="va">su.samp</span><span class="op">$</span><span class="va">buffers</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,
                        <span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">su.samp</span><span class="op">$</span><span class="va">locations</span>, pch <span class="op">=</span> <span class="fl">21</span>, col <span class="op">=</span> <span class="st">"black"</span>,
                               bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
                              <span class="op">)</span>
                      <span class="op">)</span>
    <span class="op">)</span>
<span class="co"># Set new graphics arrangement</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Plot histogram of landscape similarity values at sampling locations</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html">hist</a></span><span class="op">(</span><span class="va">su.samp</span><span class="op">$</span><span class="va">locations</span><span class="op">$</span><span class="va">land_sim</span>, <span class="fl">4</span>, main <span class="op">=</span> <span class="st">"Landscape Similarity"</span><span class="op">)</span></code></pre></div>
<p><img src="sampling_files/figure-html/spat-1.png" width="672"></p>
<hr>
<p>Clean files from temporary directory</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"/wasoil.zip"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="va">d</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<hr>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li>B.A. Fuentes, M.J. Dorantes, and J.R. Tipton. rassta: Raster-based Spatial Stratification Algorithms. <em>EarthArXiv</em>, 2021. <a href="https://doi.org/10.31223/X50S57" class="uri">https://doi.org/10.31223/X50S57</a>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bryan A. Fuentes, Minerva J. Dorantes, John R. Tipton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
